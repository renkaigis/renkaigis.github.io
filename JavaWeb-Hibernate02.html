<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="mask-icon" href="/images/favicon.png" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha256-yIDrPSXHZdOZhAqiBP7CKzIwMQmRCJ8UeB8Jo17YC4o=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"yoursite.cn","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.19.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Hibernate 配置文件与接口方法。">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaWeb 之 Hibernate 配置及接口">
<meta property="og:url" content="https://yoursite.cn/JavaWeb-Hibernate02.html">
<meta property="og:site_name" content="秋月春风等闲度">
<meta property="og:description" content="Hibernate 配置文件与接口方法。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://image.renkaigis.com/javaweb/hibernate0200.png">
<meta property="article:published_time" content="2018-05-30T08:33:19.000Z">
<meta property="article:modified_time" content="2018-08-10T06:41:30.000Z">
<meta property="article:author" content="Kai Ren">
<meta property="article:tag" content="JavaWeb">
<meta property="article:tag" content="Hibernate">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://image.renkaigis.com/javaweb/hibernate0200.png">


<link rel="canonical" href="https://yoursite.cn/JavaWeb-Hibernate02.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://yoursite.cn/JavaWeb-Hibernate02.html","path":"JavaWeb-Hibernate02.html","title":"JavaWeb 之 Hibernate 配置及接口"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>JavaWeb 之 Hibernate 配置及接口 | 秋月春风等闲度</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="秋月春风等闲度" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">秋月春风等闲度</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">要有最朴素的生活，与最遥远的梦想。即使明日天寒地冻，路远马亡。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%98%A0%E5%B0%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">1.</span> <span class="nav-text">映射配置文件</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%87%E7%AD%BE"><span class="nav-number">1.1.</span> <span class="nav-text">&lt;class&gt;标签</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%87%E7%AD%BE-1"><span class="nav-number">1.2.</span> <span class="nav-text">&lt;id&gt;标签</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%87%E7%AD%BE-2"><span class="nav-number">1.3.</span> <span class="nav-text">&lt;property&gt;标签</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">2.</span> <span class="nav-text">核心配置文件</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="nav-number">2.1.</span> <span class="nav-text">核心配置文件的两种方式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7%E6%96%87%E4%BB%B6"><span class="nav-number">2.1.1.</span> <span class="nav-text">属性文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#xml-%E6%96%87%E4%BB%B6%EF%BC%88%E2%98%85%EF%BC%89"><span class="nav-number">2.1.2.</span> <span class="nav-text">xml 文件（★）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hibernate-cfg-xml-%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3"><span class="nav-number">2.2.</span> <span class="nav-text">hibernate.cfg.xml 的配置文件详解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BF%85%E9%A1%BB%E6%9C%89%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="nav-number">2.2.1.</span> <span class="nav-text">必须有的配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E9%80%89%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="nav-number">2.2.2.</span> <span class="nav-text">可选的配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A0%E8%BD%BD%E6%98%A0%E5%B0%84"><span class="nav-number">2.2.3.</span> <span class="nav-text">加载映射</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%95%E8%A1%A8%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9A%84-Hibernate-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">2.3.</span> <span class="nav-text">单表最基本的 Hibernate 配置文件</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Hibernate-%E5%B8%B8%E7%94%A8%E7%9A%84%E6%8E%A5%E5%8F%A3%E5%92%8C%E7%B1%BB"><span class="nav-number">3.</span> <span class="nav-text">Hibernate 常用的接口和类</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Configuration-%E7%B1%BB%E5%92%8C%E4%BD%9C%E7%94%A8"><span class="nav-number">3.1.</span> <span class="nav-text">Configuration 类和作用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Configuration%E7%B1%BB"><span class="nav-number">3.1.1.</span> <span class="nav-text">Configuration类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Configuration%E7%B1%BB%E7%9A%84%E5%85%B6%E4%BB%96%E5%BA%94%E7%94%A8%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="nav-number">3.1.2.</span> <span class="nav-text">Configuration类的其他应用（了解）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SessionFactory-%E7%B1%BB-%E2%98%85"><span class="nav-number">3.2.</span> <span class="nav-text">SessionFactory 类 ★</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SessionFactory-%E7%B1%BB%E7%9A%84%E7%89%B9%E7%82%B9"><span class="nav-number">3.2.1.</span> <span class="nav-text">SessionFactory 类的特点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99-HibernateUtils-%E7%9A%84%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="nav-number">3.2.2.</span> <span class="nav-text">编写 HibernateUtils 的工具类</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Session-%E6%8E%A5%E5%8F%A3"><span class="nav-number">3.3.</span> <span class="nav-text">Session 接口</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0"><span class="nav-number">3.3.1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%B9%E7%82%B9"><span class="nav-number">3.3.2.</span> <span class="nav-text">特点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-number">3.3.3.</span> <span class="nav-text">常用的方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#get-Class-id"><span class="nav-number">3.3.3.1.</span> <span class="nav-text">get(Class,id)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#delete-obj"><span class="nav-number">3.3.3.2.</span> <span class="nav-text">delete(obj)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#update-obj"><span class="nav-number">3.3.3.3.</span> <span class="nav-text">update(obj)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#saveOrUpdate-obj"><span class="nav-number">3.3.3.4.</span> <span class="nav-text">saveOrUpdate(obj)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#createQuery"><span class="nav-number">3.3.3.5.</span> <span class="nav-text">createQuery()</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Transaction-%E6%8E%A5%E5%8F%A3"><span class="nav-number">3.4.</span> <span class="nav-text">Transaction 接口</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E7%9A%84%E6%96%B9%E6%B3%95-1"><span class="nav-number">3.4.1.</span> <span class="nav-text">常用的方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%B9%E7%82%B9-1"><span class="nav-number">3.4.2.</span> <span class="nav-text">特点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E4%BA%8B%E5%8A%A1"><span class="nav-number">3.4.3.</span> <span class="nav-text">测试事务</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Kai Ren"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Kai Ren</p>
  <div class="site-description" itemprop="description">一枚想成为技术控的菜鸟</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">49</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/renkaigis" title="Github → https:&#x2F;&#x2F;github.com&#x2F;renkaigis" rel="noopener me" target="_blank">Github</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/renkaigis" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;renkaigis" rel="noopener me" target="_blank">Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="http://blog.csdn.net/renkaigis" title="Linkedin → http:&#x2F;&#x2F;blog.csdn.net&#x2F;renkaigis" rel="noopener me" target="_blank">Linkedin</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:renkaigis@gmail.com" title="Email → mailto:renkaigis@gmail.com" rel="noopener me" target="_blank">Email</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          Links
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://yongzesong.com/" title="https:&#x2F;&#x2F;yongzesong.com" rel="noopener" target="_blank">Dr. Yongze Song</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://yoursite.cn/JavaWeb-Hibernate02.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Kai Ren">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="秋月春风等闲度">
      <meta itemprop="description" content="一枚想成为技术控的菜鸟">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="JavaWeb 之 Hibernate 配置及接口 | 秋月春风等闲度">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          JavaWeb 之 Hibernate 配置及接口
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2018-05-30 16:33:19" itemprop="dateCreated datePublished" datetime="2018-05-30T16:33:19+08:00">2018-05-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2018-08-10 14:41:30" itemprop="dateModified" datetime="2018-08-10T14:41:30+08:00">2018-08-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/JavaWeb/" itemprop="url" rel="index"><span itemprop="name">JavaWeb</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><div align="center"><img src="http://image.renkaigis.com/javaweb/hibernate0200.png"></div>

<p id="div-border-left-green">Hibernate 配置文件与接口方法。</p>

<span id="more"></span>

<hr>
<h1 id="映射配置文件"><a href="#映射配置文件" class="headerlink" title="映射配置文件"></a>映射配置文件</h1><hr>
<p>映射文件，即类与表的映射配置文件，假设是 <code>Customer.hbm.xml</code></p>
<h2 id="标签"><a href="#标签" class="headerlink" title="&lt;class&gt;标签"></a><code>&lt;class&gt;标签</code></h2><table>
<thead>
<tr>
<th align="center">&lt;class&gt; 标签</th>
<th>用来将类与数据库表建立映射关系</th>
</tr>
</thead>
<tbody><tr>
<td align="center">name</td>
<td>类的全路径</td>
</tr>
<tr>
<td align="center">table</td>
<td>表名.(类名与表名一致,那么table属性也可以省略)</td>
</tr>
<tr>
<td align="center">catalog</td>
<td>数据库的名称，基本上都会省略不写</td>
</tr>
</tbody></table>
<h2 id="标签-1"><a href="#标签-1" class="headerlink" title="&lt;id&gt;标签"></a><code>&lt;id&gt;标签</code></h2><table>
<thead>
<tr>
<th align="center">&lt;id&gt; 标签</th>
<th>用来将类中的属性与表中的主键建立映射，id 标签就是用来配置主键的</th>
</tr>
</thead>
<tbody><tr>
<td align="center">name</td>
<td>类中属性名</td>
</tr>
<tr>
<td align="center">column</td>
<td>表中的字段名。（如果类中的属性名与表中的字段名一致,那么 column 可以省略。）</td>
</tr>
<tr>
<td align="center">length</td>
<td>字段的程度，如果数据库已经创建好了，那么 length 可以不写。如果没有创建好，生成表结构时，length 最好指定。</td>
</tr>
</tbody></table>
<h2 id="标签-2"><a href="#标签-2" class="headerlink" title="&lt;property&gt;标签"></a><code>&lt;property&gt;标签</code></h2><table>
<thead>
<tr>
<th align="center">&lt;property&gt; 标签</th>
<th>用来将类中的普通属性与表中的字段建立映射</th>
</tr>
</thead>
<tbody><tr>
<td align="center">name</td>
<td>类中属性名</td>
</tr>
<tr>
<td align="center">column</td>
<td>表中的字段名（如果类中的属性名与表中的字段名一致,那么column可以省略。）</td>
</tr>
<tr>
<td align="center">length</td>
<td>数据长度</td>
</tr>
<tr>
<td align="center">type</td>
<td>数据类型（一般都不需要编写，如果写需要按着规则来编写）<br/>Hibernate 的数据类型	type&#x3D;”string”<br/>Java 的数据类型		type&#x3D;”java.lang.String”<br/> 数据库字段的数据类型	&lt;column name&#x3D;”name” sql-type&#x3D;”varchar”&#x2F;&gt;</td>
</tr>
</tbody></table>
<p><strong>注：</strong> 配置不需要那么麻烦，一般默认的就可以了。</p>
<hr>
<h1 id="核心配置文件"><a href="#核心配置文件" class="headerlink" title="核心配置文件"></a>核心配置文件</h1><hr>
<h2 id="核心配置文件的两种方式"><a href="#核心配置文件的两种方式" class="headerlink" title="核心配置文件的两种方式"></a>核心配置文件的两种方式</h2><h3 id="属性文件"><a href="#属性文件" class="headerlink" title="属性文件"></a>属性文件</h3><p>第一种方式是属性文件的形式，即 properties 的配置文件</p>
<p><code>hibernate.properties</code> 里面的编写规则如下：（key&#x3D;value）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hibernate.connection.driver_class=com.mysql.jdbc.Driver</span><br></pre></td></tr></table></figure>

<p>缺点：不能加载映射的配置文件，需要手动编写代码去加载</p>
<h3 id="xml-文件（★）"><a href="#xml-文件（★）" class="headerlink" title="xml 文件（★）"></a>xml 文件（<strong>★</strong>）</h3><p>第二种方式是 XML 文件的形式，开发基本都会选择这种方式（<strong>★</strong>）</p>
<p><code>hibernate.cfg.xml</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.driver_class&quot;</span> &gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>优点</strong></p>
<ul>
<li>格式比较清晰</li>
<li>编写有提示</li>
<li>可以在该配置文件中加载映射的配置文件（最主要的）</li>
</ul>
<h2 id="hibernate-cfg-xml-的配置文件详解"><a href="#hibernate-cfg-xml-的配置文件详解" class="headerlink" title="hibernate.cfg.xml 的配置文件详解"></a><code>hibernate.cfg.xml</code> 的配置文件详解</h2><h3 id="必须有的配置"><a href="#必须有的配置" class="headerlink" title="必须有的配置"></a>必须有的配置</h3><ul>
<li>数据库连接信息:</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hibernate.connection.driver_class       -- 连接数据库驱动程序</span><br><span class="line">hibernate.connection.url        -- 连接数据库 URL</span><br><span class="line">hibernate.connection.username       -- 数据库用户名</span><br><span class="line">hibernate.connection.password       -- 数据库密码</span><br></pre></td></tr></table></figure>

<ul>
<li>方言:</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hibernate.dialect       -- 操作数据库方言</span><br></pre></td></tr></table></figure>
<h3 id="可选的配置"><a href="#可选的配置" class="headerlink" title="可选的配置"></a>可选的配置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* hibernate.show_sql        -- 显示 SQL，控制台输出 SQL 语句</span><br><span class="line">* hibernate.format_sql      -- 格式化控制台输出的 SQL 语句</span><br><span class="line"></span><br><span class="line">* hibernate.hbm2ddl.auto        -- 通过映射转成DDL语句</span><br><span class="line">    * create            -- 每次都会创建一个新的表。 ---测试的时候使用</span><br><span class="line">    * create-drop       -- 每次都会创建一个新的表，当执行结束之后，将创建的这个表删除。   ---测试的时候使用</span><br><span class="line">    * update★            -- 如果有表，使用原来的表。没有表，创建一个新的表。同时更新表结构。</span><br><span class="line">    * validate          -- 如果有表，使用原来的表。同时校验映射文件与表中字段是否一致如果不一致就会报错。</span><br></pre></td></tr></table></figure>

<h3 id="加载映射"><a href="#加载映射" class="headerlink" title="加载映射"></a>加载映射</h3><ul>
<li>如果是 XML 方式：</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">&quot;com/renkaigis/domain/Customer.hbm.xml&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="单表最基本的-Hibernate-配置文件"><a href="#单表最基本的-Hibernate-配置文件" class="headerlink" title="单表最基本的 Hibernate 配置文件"></a>单表最基本的 Hibernate 配置文件</h2><p><code>hibernate.cfg.xml</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">hibernate-configuration</span> <span class="keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;-//Hibernate/Hibernate Configuration DTD 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--记住：先配置 SessionFactory 标签，一个数据库对应一个 SessionFactory 标签--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--必须配置的参数有 5 个，4 大参数和数据库的方言--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.driver_class&quot;</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.url&quot;</span>&gt;</span>jdbc:mysql:///hibernate_01<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.username&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.password&quot;</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--数据库的方言--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.dialect&quot;</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--可选配置--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--控制台显示 SQL 语句--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;show_sql&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--格式化显示的 SQL 语句--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;format_sql&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--生成数据库表结构--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.hbm2ddl.auto&quot;</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--映射配置文件，需要引入映射的配置文件--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">&quot;com/renkaigis/domain/Customer.hbm.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<hr>
<h1 id="Hibernate-常用的接口和类"><a href="#Hibernate-常用的接口和类" class="headerlink" title="Hibernate 常用的接口和类"></a>Hibernate 常用的接口和类</h1><hr>
<h2 id="Configuration-类和作用"><a href="#Configuration-类和作用" class="headerlink" title="Configuration 类和作用"></a>Configuration 类和作用</h2><h3 id="Configuration类"><a href="#Configuration类" class="headerlink" title="Configuration类"></a>Configuration类</h3><ul>
<li><p>Configuration 对象用于配置并且启动 Hibernate。</p>
</li>
<li><p>Hibernate 应用通过该对象来获得 <code>对象-关系映射</code> 文件中的元数据，以及动态配置 Hibernate 的属性，然后创建 SessionFactory 对象。</p>
</li>
</ul>
<p>简而言之：加载 Hibernate 的配置文件，可以获取 SessionFactory 对象。</p>
<h3 id="Configuration类的其他应用（了解）"><a href="#Configuration类的其他应用（了解）" class="headerlink" title="Configuration类的其他应用（了解）"></a>Configuration类的其他应用（了解）</h3><p>加载配置文件的种类，Hibernate 支持 xml 和 properties 类型的配置文件，在开发中基本都使用 XML 配置文件的方式。</p>
<ul>
<li>如果采用的是 properties 的配置文件，那么通过下面语句可以加载配置文件</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br></pre></td></tr></table></figure>

<p>但是需要自己手动加载映射文件</p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config.addResource(<span class="string">&quot;cn/itcast/domain/Student.hbm.xml&quot;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>如果采用的 XML 的配置文件，通过下面语句可直接加载配置文件和映射文件。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>().configure();</span><br></pre></td></tr></table></figure>

<h2 id="SessionFactory-类-★"><a href="#SessionFactory-类-★" class="headerlink" title="SessionFactory 类 ★"></a>SessionFactory 类 ★</h2><p>SessionFactory 是工厂类，负责初始化 Hibernate，充当数据存储源，并负责创建 Session 对象。</p>
<h3 id="SessionFactory-类的特点"><a href="#SessionFactory-类的特点" class="headerlink" title="SessionFactory 类的特点"></a>SessionFactory 类的特点</h3><ul>
<li><p>由Configuration 通过加载配置文件创建该对象。</p>
</li>
<li><p>SessionFactory 对象中保存了当前的数据库配置信息和所有映射关系以及预定义的 SQL 语句。同时，SessionFactory 还负责维护 Hibernate 的二级缓存。</p>
</li>
<li><ul>
<li>预定义 SQL 语句</li>
</ul>
</li>
<li><ul>
<li><ul>
<li>使用 Configuration 类创建了 SessionFactory 对象时，已经在 SessionFacotry 对象中缓存了一些 SQL 语句；</li>
</ul>
</li>
</ul>
</li>
<li><ul>
<li><ul>
<li>常见的SQL语句是增删改查（通过主键来查询）；</li>
</ul>
</li>
</ul>
</li>
<li><ul>
<li><ul>
<li>这样做的目的是效率更高。</li>
</ul>
</li>
</ul>
</li>
<li><p>一个 SessionFactory 实例对应一个数据库，应用从该对象中获得 Session 实例。</p>
</li>
<li><p>SessionFactory 是 <code>线程安全</code> 的，意味着它的一个实例可以被应用的多个线程共享。</p>
</li>
<li><p>SessionFactory 是 <code>重量级</code> 的，意味着不能随意创建或销毁它的实例。如果只访问一个数据库，只需要创建一个 SessionFactory 实例，且在应用初始化的时候完成。</p>
</li>
<li><p>SessionFactory 需要一个较大的缓存，用来存放预定义的SQL语句及实体的映射信息。另外可以配置一个缓存插件，这个插件被称之为 Hibernate 的二级缓存，被多线程所共享。</p>
</li>
</ul>
<p>总之，一般应用使用一个 SessionFactory，最好是应用启动时就完成初始化。</p>
<h3 id="编写-HibernateUtils-的工具类"><a href="#编写-HibernateUtils-的工具类" class="headerlink" title="编写 HibernateUtils 的工具类"></a>编写 HibernateUtils 的工具类</h3><p>简化获取 Session 的方法，在服务器启动时就完成了初始化，加载了配置文件和映射文件。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HibernateUtils</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Configuration cfg;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> SessionFactory factory;</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="comment">// 给常量赋值 </span></span><br><span class="line">        <span class="comment">// 加载配置文件</span></span><br><span class="line">        cfg = <span class="keyword">new</span> <span class="title class_">Configuration</span>().configure();</span><br><span class="line">        <span class="comment">// 生成factory对象</span></span><br><span class="line">        factory = cfg.buildSessionFactory();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 获取Session对象</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Session <span class="title function_">openSession</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> factory.openSession();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试工具类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSave2</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 通过工具类获取 session 对象</span></span><br><span class="line">    <span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> HibernateUtils.getSession();</span><br><span class="line">    <span class="type">Transaction</span> <span class="variable">tr</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">    Customer c=<span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">    c.setCust_name(<span class="string">&quot;小明&quot;</span>);</span><br><span class="line">    session.save(c);</span><br><span class="line"></span><br><span class="line">    tr.commit();</span><br><span class="line">    session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Session-接口"><a href="#Session-接口" class="headerlink" title="Session 接口"></a>Session 接口</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><ul>
<li>Session 是在 Hibernate 中使用最频繁的接口。也被称之为 <code>持久化管理器</code>。它提供了和持久化有关的操作，比如添加、修改、删除、加载和查询实体对象；</li>
<li>Session 是应用程序与数据库之间交互操作的一个单线程对象，是 Hibernate 运作的中心；</li>
<li>Session 是线程不安全的；</li>
<li>所有持久化对象必须在 session 的管理下才可以进行持久化操作；</li>
<li>Session 对象有一个一级缓存，显式执行 flush 之前，所有的持久化操作的数据都缓存在 session 对象处；</li>
<li>持久化类与 Session 关联起来后就具有了持久化的能力。</li>
</ul>
<h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><ul>
<li><code>不是线程安全</code> 的。应避免多个线程使用同一个 Session 实例；</li>
<li>Session 是 <code>轻量级</code> 的，它的创建和销毁不会消耗太多的资源。应为每次客户请求分配独立的 Session 实例；</li>
<li>Session 有一个缓存，被称之为 Hibernate 的一级缓存。每个 Session 实例都有自己的缓存。</li>
</ul>
<h3 id="常用的方法"><a href="#常用的方法" class="headerlink" title="常用的方法"></a>常用的方法</h3><ul>
<li>save(obj)</li>
<li>delete(obj)</li>
<li>get(Class,id)</li>
<li>update(obj)</li>
<li>saveOrUpdate(obj)					– 保存或者修改（如果没有数据，保存数据。如果有，修改数据）</li>
<li>createQuery() 					– HQL语句的查询的方式</li>
</ul>
<h4 id="get-Class-id"><a href="#get-Class-id" class="headerlink" title="get(Class,id)"></a>get(Class,id)</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试 get() 方法，获取查询，通过主键来查询一条记录</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testGet</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 通过工具类获取 session 对象</span></span><br><span class="line">    <span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> HibernateUtils.getSession();</span><br><span class="line">    <span class="type">Transaction</span> <span class="variable">tr</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 两个参数：JavaBean 的 class 对象，主键的值</span></span><br><span class="line">    <span class="type">Customer</span> <span class="variable">c</span> <span class="operator">=</span> session.get(Customer.class, <span class="number">94L</span>);</span><br><span class="line">    System.out.println(c);</span><br><span class="line"></span><br><span class="line">    tr.commit();</span><br><span class="line">    session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Customer&#123;cust_id=94, cust_name=&#x27;测试&#x27;, cust_user_id=null, cust_create_id=null, cust_source=&#x27;null&#x27;, cust_industry=&#x27;null&#x27;, cust_level=&#x27;2&#x27;, cust_linkman=&#x27;null&#x27;, cust_phone=&#x27;110&#x27;, cust_mobile=&#x27;null&#x27;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="delete-obj"><a href="#delete-obj" class="headerlink" title="delete(obj)"></a>delete(obj)</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试 delete() 方法</span></span><br><span class="line"><span class="comment"> * 注意：删除或者修改，都要先查询在删除或者修改</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testDel</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 通过工具类获取 session 对象</span></span><br><span class="line">    <span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> HibernateUtils.getSession();</span><br><span class="line">    <span class="type">Transaction</span> <span class="variable">tr</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line"></span><br><span class="line">    <span class="type">Customer</span> <span class="variable">c</span> <span class="operator">=</span> session.get(Customer.class, <span class="number">94L</span>);</span><br><span class="line">    <span class="comment">// 删除客户</span></span><br><span class="line">    session.delete(c);</span><br><span class="line"></span><br><span class="line">    tr.commit();</span><br><span class="line">    session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出 SQL 语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Hibernate: </span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        customer0_.cust_id <span class="keyword">as</span> cust_id1_0_0_,</span><br><span class="line">        customer0_.cust_name <span class="keyword">as</span> cust_nam2_0_0_,</span><br><span class="line">        customer0_.cust_user_id <span class="keyword">as</span> cust_use3_0_0_,</span><br><span class="line">        customer0_.cust_create_id <span class="keyword">as</span> cust_cre4_0_0_,</span><br><span class="line">        customer0_.cust_source <span class="keyword">as</span> cust_sou5_0_0_,</span><br><span class="line">        customer0_.cust_industry <span class="keyword">as</span> cust_ind6_0_0_,</span><br><span class="line">        customer0_.cust_level <span class="keyword">as</span> cust_lev7_0_0_,</span><br><span class="line">        customer0_.cust_linkman <span class="keyword">as</span> cust_lin8_0_0_,</span><br><span class="line">        customer0_.cust_phone <span class="keyword">as</span> cust_pho9_0_0_,</span><br><span class="line">        customer0_.cust_mobile <span class="keyword">as</span> cust_mo10_0_0_ </span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        cst_customer customer0_ </span><br><span class="line">    <span class="keyword">where</span></span><br><span class="line">        customer0_.cust_id<span class="operator">=</span>?</span><br><span class="line">Hibernate: </span><br><span class="line">    <span class="keyword">delete</span> </span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        cst_customer </span><br><span class="line">    <span class="keyword">where</span></span><br><span class="line">        cust_id<span class="operator">=</span>?</span><br></pre></td></tr></table></figure>

<h4 id="update-obj"><a href="#update-obj" class="headerlink" title="update(obj)"></a>update(obj)</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试 update() 方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testUpdate</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 通过工具类获取 session 对象</span></span><br><span class="line">    <span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> HibernateUtils.getSession();</span><br><span class="line">    <span class="type">Transaction</span> <span class="variable">tr</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">    <span class="comment">// 查询客户</span></span><br><span class="line">    <span class="type">Customer</span> <span class="variable">c</span> <span class="operator">=</span> session.get(Customer.class, <span class="number">1L</span>);</span><br><span class="line">    <span class="comment">// 设置客户信息</span></span><br><span class="line">    c.setCust_level(<span class="string">&quot;中级&quot;</span>);</span><br><span class="line">    c.setCust_name(<span class="string">&quot;小徐&quot;</span>);</span><br><span class="line">    <span class="comment">// 修改</span></span><br><span class="line">    session.update(c);</span><br><span class="line"></span><br><span class="line">    tr.commit();</span><br><span class="line">    session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="saveOrUpdate-obj"><a href="#saveOrUpdate-obj" class="headerlink" title="saveOrUpdate(obj)"></a>saveOrUpdate(obj)</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试 SaveOrUpdate() 方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSaveOrUpdate</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 通过工具类获取 session 对象</span></span><br><span class="line">    <span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> HibernateUtils.getSession();</span><br><span class="line">    <span class="type">Transaction</span> <span class="variable">tr</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">    <span class="comment">// 查询客户</span></span><br><span class="line">    <span class="type">Customer</span> <span class="variable">c</span> <span class="operator">=</span> session.get(Customer.class, <span class="number">1L</span>);</span><br><span class="line">    <span class="comment">// 设置客户信息</span></span><br><span class="line">    <span class="comment">// c.setCust_id(7L); // 千万不能修改 id 值</span></span><br><span class="line">    c.setCust_name(<span class="string">&quot;小天&quot;</span>);</span><br><span class="line">    <span class="comment">// 修改</span></span><br><span class="line">    session.saveOrUpdate(c);</span><br><span class="line"></span><br><span class="line">    tr.commit();</span><br><span class="line">    session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="createQuery"><a href="#createQuery" class="headerlink" title="createQuery()"></a>createQuery()</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试 creatQuery() 方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSel</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> HibernateUtils.getSession();</span><br><span class="line">    <span class="type">Transaction</span> <span class="variable">tr</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">    <span class="comment">// 创建查询的接口</span></span><br><span class="line">    <span class="type">Query</span> <span class="variable">query</span> <span class="operator">=</span> session.createQuery(<span class="string">&quot;from Customer&quot;</span>);</span><br><span class="line">    <span class="comment">// 查询所有的数据 select * from 表</span></span><br><span class="line">    List&lt;Customer&gt; list = query.list();</span><br><span class="line">    <span class="keyword">for</span> (Customer customer :</span><br><span class="line">            list) &#123;</span><br><span class="line">        System.out.println(customer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    tr.commit();</span><br><span class="line">    session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Transaction-接口"><a href="#Transaction-接口" class="headerlink" title="Transaction 接口"></a>Transaction 接口</h2><p>Transaction 是事务的接口。</p>
<h3 id="常用的方法-1"><a href="#常用的方法-1" class="headerlink" title="常用的方法"></a>常用的方法</h3><ul>
<li>commit()				– 提交事务</li>
<li>rollback()			– 回滚事务</li>
</ul>
<h3 id="特点-1"><a href="#特点-1" class="headerlink" title="特点"></a>特点</h3><ul>
<li>Hibernate 框架默认情况下事务不自动提交.需要手动提交事务</li>
<li>如果没有开启事务，那么每个 Session 的操作，都相当于一个独立的事务</li>
</ul>
<h3 id="测试事务"><a href="#测试事务" class="headerlink" title="测试事务"></a>测试事务</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试事务</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSave3</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">Transaction</span> <span class="variable">tr</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        session = HibernateUtils.getSession();</span><br><span class="line">        <span class="comment">// 开启事务</span></span><br><span class="line">        tr = session.beginTransaction();</span><br><span class="line">        <span class="type">Customer</span> <span class="variable">c</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">        <span class="comment">// int a=10/0;</span></span><br><span class="line">        c.setCust_name(<span class="string">&quot;嘿嘿&quot;</span>);</span><br><span class="line">        session.save(c);</span><br><span class="line">        tr.commit();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="comment">// 回滚事务</span></span><br><span class="line">        tr.rollback();</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">// 释放资源</span></span><br><span class="line">        session.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechat-reward-image.png" alt="Kai Ren WeChat Pay">
        <span>WeChat Pay</span>
      </div>
      <div>
        <img src="/images/alipay-reward-image.png" alt="Kai Ren Alipay">
        <span>Alipay</span>
      </div>
      <div>
        <img src="/%E5%AE%A0%E8%BE%B1%E4%B8%8D%E6%83%8A%EF%BC%8C%E7%9C%8B%E5%BA%AD%E5%89%8D%E8%8A%B1%E5%BC%80%E8%8A%B1%E8%90%BD%EF%BC%9B%E5%8E%BB%E7%95%99%E6%97%A0%E6%84%8F%EF%BC%8C%E6%9C%9B%E5%A4%A9%E4%B8%8A%E4%BA%91%E5%8D%B7%E4%BA%91%E8%88%92%E3%80%82" alt="Kai Ren reward_comment">
        <span>reward_comment</span>
      </div>

  </div>
</div>

          <div class="post-tags">
              <a href="/tags/JavaWeb/" rel="tag"># JavaWeb</a>
              <a href="/tags/Hibernate/" rel="tag"># Hibernate</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/JavaWeb-Hibernate01.html" rel="prev" title="JavaWeb 之 Hibernate 快速入门">
                  <i class="fa fa-angle-left"></i> JavaWeb 之 Hibernate 快速入门
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/JavaWeb-Hibernate03.html" rel="next" title="JavaWeb 之 Hibernate 持久化类、缓存与事务">
                  JavaWeb 之 Hibernate 持久化类、缓存与事务 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2017 – 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">ture</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/renkaigis" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.2/anime.min.js" integrity="sha256-tc4b48P1MPGS4PJXHRlChGCW1mEZy62jS/3JEsSHPzU=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
